var U=Object.defineProperty,q=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var V=(e,t,l)=>t in e?U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,M=(e,t)=>{for(var l in t||(t={}))W.call(t,l)&&V(e,l,t[l]);if(B)for(var l of B(t))G.call(t,l)&&V(e,l,t[l]);return e},L=(e,t)=>q(e,O(t));import{k as _,l as p,m as R,u as r,n as Y,t as H,p as J,q as Q,d as z,o as E,c as F,a as u,F as X,s as Z,v as N,x as ee,y as te,z as le,A,B as oe,C as ne,D as ae,E as ue,r as I,e as se,w as x,b as f,G as T,H as re}from"./vendor.57e2564e.js";import{_ as j}from"./index.68be8b49.js";const ie="https://www.getphotoblanket.com",P=({page:e=1,pageSize:t=20})=>{const l=`${ie}/products.json?page=${e}&limit=${t}`;return fetch(l).then(o=>o.json()).then(o=>o.products)},ce={list:{type:Array,default:()=>[]},grid:{type:Number,default:1},height:{type:Number,default:0},rowKey:{type:String,default:"id"},onTouchEnd:{type:Function,default:null},loadingText:{type:String,default:"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u7B49"},bufferCount:{type:Number,default:4},wrapperStyle:{type:Object,default:()=>{}},colSpace:{type:Number,default:0},rowSpace:{type:Number,default:0}};function de(e){const t=_(()=>e.height+e.rowSpace),l=p(),o=p(0);return R(()=>{!l.value||(o.value=~~(l.value.offsetHeight/t.value)+2)}),{scrollContainer:l,viewSize:o}}function ve(e,t){function l(...o){e(()=>t.apply(this,o),{fn:t,thisArg:this,args:o})}return l}function fe(e,t=!0,l=!0){let o=0,n,s=!l;const c=()=>{n&&(clearTimeout(n),n=void 0)};return d=>{const h=r(e),D=Date.now()-o;if(c(),h<=0)return o=Date.now(),d();D>h&&(o=Date.now(),s?s=!1:d()),t&&(n=setTimeout(()=>{o=Date.now(),l||(s=!0),c(),d()},h)),!l&&!n&&(n=setTimeout(()=>s=!0,h))}}function he(e,t=200,l=!0,o=!0){return ve(fe(t,l,o),e)}function _e(e,t,l,o){const n=_(()=>e.height+e.rowSpace),s=p(0),c=_(()=>Math.min(s.value+l.value*e.grid-1,e.list.length-1)),m=_(()=>Math.max(s.value-e.bufferCount*e.grid,0)),d=_(()=>Math.min(c.value+e.bufferCount*e.grid,e.list.length-1)),h=_(()=>e.list.slice(m.value,d.value+1)),D=he(()=>{!t.value||(s.value=Math.max(0,~~(t.value.scrollTop/n.value))*e.grid,s.value+l.value*e.grid>=e.list.length&&C(),o(H(s.value),H(c.value)))},100);function S(w,v=0){if(!t.value)return;const y=~~(w/e.grid);t.value.scrollTop=y*n.value+v,s.value=y*e.grid}const a=p(!1),i=p(!1),g=p(""),$=async()=>{a.value=!1,i.value=!1,g.value="",await Y(),C()};function C(){if(!!e.onTouchEnd&&!a.value){a.value=!0;const w=e.onTouchEnd();w&&w.then?w.then(()=>{i.value=!1,a.value=!1}).catch(v=>{i.value=!0,g.value=v}):w===!0?(i.value=!1,a.value=!1):(i.value=!0,g.value=w)}}return{viewStartIndex:m,viewEndIndex:d,viewList:h,locked:a,loadError:i,errorText:g,handleScroll:D,handleRefresh:$,scrollToIndex:S}}function pe(e,t,l){const o=_(()=>e.height+e.rowSpace),n=_(()=>~~(t.value/e.grid)*o.value),s=_(()=>Math.max(~~((e.list.length-l.value)/e.grid),0)*o.value),c=_(()=>{const d=typeof e.wrapperStyle=="object"?e.wrapperStyle:{};return L(M({},d),{display:"flex",flexWrap:"wrap",paddingTop:`${n.value}px`,paddingBottom:`${s.value}px`})}),m=_(()=>({boxSizing:"border-box",width:`${1/e.grid*100}%`,paddingLeft:e.colSpace===0?0:`${e.colSpace/2}px`,paddingRight:e.colSpace===0?0:`${e.colSpace/2}px`,marginBottom:`${e.rowSpace}px`}));return{containerStyle:c,itemStyle:m}}function me(e){const t=p(0);J(()=>{!e.value||e.value.scrollTop!==t.value&&(e.value.scrollTop=t.value)}),Q(()=>{!e.value||(t.value=e.value.scrollTop)})}const K=e=>(oe("data-v-b2eedfea"),e=e(),ne(),e),ge={class:"scroll-container__bottom"},we={key:0,class:"loading-state"},ye=K(()=>u("span",{class:"icon rotate"},[u("svg",{t:"1651889853940",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1937",width:"48",height:"48"},[u("path",{d:"M533.333333 682.666667v192h-64v-192h64z m-175.317333-72.618667l45.269333 45.269333-135.765333 135.744-45.248-45.226666 135.744-135.786667z m286.634667 0l135.744 135.765333-45.226667 45.248-135.786667-135.744 45.269334-45.269333zM330.666667 480v64h-192v-64h192z m533.333333 0v64h-192v-64h192z m-128.853333-247.061333l45.248 45.226666-135.744 135.786667-45.269334-45.269333 135.765334-135.744z m-467.626667 0l135.765333 135.744-45.269333 45.269333-135.744-135.765333 45.226667-45.248zM533.333333 149.333333v192h-64V149.333333h64z","p-id":"1938"})])],-1)),xe={class:"loading-text"},Se=K(()=>u("span",{class:"icon"},[u("svg",{t:"1651893386303",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2092",width:"48",height:"48"},[u("path",{d:"M512 973.653333a34.133333 34.133333 0 0 1-24.132267-58.2656l27.050667-27.067733h-3.771733c-102.8096 0-191.8976-36.949333-264.772267-109.841067S136.533333 616.209067 136.533333 512.853333c0-69.6832 17.134933-133.597867 50.944-189.934933a34.133333 34.133333 0 0 1 58.538667 35.1232C218.658133 403.626667 204.8 455.714133 204.8 512.853333c0 85.794133 29.3888 156.893867 89.838933 217.361067 60.450133 60.450133 131.2768 89.838933 216.507734 89.838933h3.771733l-27.050667-27.067733a34.133333 34.133333 0 1 1 48.264534-48.264533l85.282133 85.282133 0.529067 0.529067c3.0208 3.140267 5.307733 6.7072 6.877866 10.496a34.030933 34.030933 0 0 1-7.355733 37.290666l-85.333333 85.333334c-6.673067 6.656-15.394133 10.001067-24.132267 10.001066z m297.7792-257.706666a34.1504 34.1504 0 0 1-29.508267-51.2512C806.0928 620.1344 819.2 569.0368 819.2 512.853333c0-85.794133-29.3888-156.893867-89.838933-217.361066-60.4672-60.450133-131.293867-89.838933-216.541867-89.838934h-3.191467l27.221334 26.948267a34.133333 34.133333 0 0 1-48.0256 48.520533l-86.186667-85.333333-0.8704-0.887467-0.017067-0.034133-0.034133-0.034133a34.133333 34.133333 0 0 1 0.8704-47.496534l86.135467-86.1184a34.133333 34.133333 0 1 1 48.264533 48.264534L509.0816 137.386667h3.754667c102.8096 0 191.914667 36.9664 264.8064 109.841066S887.466667 409.480533 887.466667 512.853333c0 68.369067-16.1792 130.9696-48.110934 186.077867a34.116267 34.116267 0 0 1-29.576533 17.015467z","p-id":"2093"})])],-1)),Te={class:"loading-text"},be=z({props:ce,emits:{scroll:null},setup(e,{expose:t,emit:l}){const o=e,{scrollContainer:n,viewSize:s}=de(o),c=(y,k)=>{const b=n.value?n.value.scrollTop:0;l("scroll",y,b)};function m(y){!n.value||n.value.scrollTop!==y&&(n.value.scrollTop=y)}const{viewStartIndex:d,viewEndIndex:h,viewList:D,locked:S,loadError:a,errorText:i,handleScroll:g,handleRefresh:$,scrollToIndex:C}=_e(o,n,s,c);t({scrollToIndex:C,scrollToPos:m});const{containerStyle:w,itemStyle:v}=pe(o,d,h);return me(n),(y,k)=>(E(),F("div",{ref_key:"scrollContainer",ref:n,class:"scroll-container",onScrollPassive:k[1]||(k[1]=(...b)=>r(g)&&r(g)(...b))},[u("ul",{class:"scroll-container__list",style:N(r(w))},[(E(!0),F(X,null,Z(r(D),b=>(E(),F("li",{key:b[y.rowKey],class:"scroll-container__item",style:N(r(v))},[ee(y.$slots,"default",{item:b},void 0,!0)],4))),128))],4),te(u("div",ge,[r(a)?(E(),F("div",{key:1,class:"loading-state cursor",onClick:k[0]||(k[0]=(...b)=>r($)&&r($)(...b))},[Se,u("p",Te,A(r(i)),1)])):(E(),F("div",we,[ye,u("p",xe,A(y.loadingText),1)]))],512),[[le,r(S)]])],544))}});var De=j(be,[["__scopeId","data-v-b2eedfea"]]);const $e={class:"cover"},Ce=["src"],Ee={class:"info"},Fe={class:"bottom"},Ae=z({props:{details:{type:Object,default:()=>{}}},setup(e){const t=e,l=ae(),o=_(()=>t.details&&t.details.images&&t.details.images[0]?t.details.images[0].src:"");function n(){l.push({path:"/details",query:{source:o.value,vendor:t.details.vendor,title:t.details.title}})}return(s,c)=>(E(),F("div",{class:"product-card",onClick:n},[u("div",$e,[u("img",{src:r(o),alt:"",srcset:""},null,8,Ce)]),u("div",Ee,[u("h2",null,A(e.details.title),1),u("div",Fe,[u("h3",null,"$ "+A(e.details.variants[0].price),1),u("h4",null,A(e.details.id),1)])])]))}});var ke=j(Ae,[["__scopeId","data-v-ac088862"]]);const Ie={style:{padding:"10px","background-color":"#fff"}},ze=T("\u56DE\u8C03\u6570\u636E"),Be=T("\u5217\u6570"),Ve=T("\u6EDA\u52A8\u5230y\u8F74\u50CF\u7D20"),Me=T(" \xA0 "),Le=T("\u6EDA\u52A8\u5230"),He=T("\u6EDA\u52A8\u5230\u5361\u7247\u7D22\u5F15"),Ne=T(" \xA0 "),Pe=T("\u6EDA\u52A8\u5230"),Re={class:"content"},je={class:"product-item"},Oe=z({setup(e){const t=p([]),l=p(null);R(async()=>{t.value=await P({page:1,pageSize:250})});function o(){return new Promise((S,a)=>{P({page:1,pageSize:50}).then(i=>{Math.random()>.3?(t.value.push(...i),S(!0)):a(new Error("\u52A0\u8F7D\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u65B0\u62C9\u53D6\u6570\u636E"))})})}const n=p("");function s(S,a){n.value=`startIndex:, ${S}, posy:, ${a}`}const c=ue({grid:2,height:120,rowKey:"id",loadingText:"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u7B49",bufferCount:4,wrapperStyle:{},colSpace:10,rowSpace:10}),m=p(0);function d(){l.value&&l.value.scrollToPos(m.value)}const h=p(0);function D(S){l.value&&l.value.scrollToIndex(h.value)}return(S,a)=>{const i=I("el-divider"),g=I("el-input-number"),$=I("el-button"),C=I("el-col"),w=I("el-row");return E(),se(w,null,{default:x(()=>[f(C,{span:8},{default:x(()=>[u("div",Ie,[f(i,null,{default:x(()=>[ze]),_:1}),T(" "+A(n.value)+" ",1),f(i,null,{default:x(()=>[Be]),_:1}),f(g,{modelValue:r(c).grid,"onUpdate:modelValue":a[0]||(a[0]=v=>r(c).grid=v),onChange:a[1]||(a[1]=()=>{})},null,8,["modelValue"]),f(i,null,{default:x(()=>[Ve]),_:1}),f(g,{modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=v=>m.value=v)},null,8,["modelValue"]),Me,f($,{type:"primary",onClick:d},{default:x(()=>[Le]),_:1}),f(i,null,{default:x(()=>[He]),_:1}),f(g,{modelValue:h.value,"onUpdate:modelValue":a[3]||(a[3]=v=>h.value=v)},null,8,["modelValue"]),Ne,f($,{type:"primary",onClick:D},{default:x(()=>[Pe]),_:1})])]),_:1}),f(C,{span:16},{default:x(()=>[u("div",Re,[f(r(De),re({ref_key:"vScroll",ref:l},r(c),{list:t.value,"on-touch-end":o,onScroll:s}),{default:x(({item:v})=>[u("div",je,[f(ke,{details:v},null,8,["details"])])]),_:1},16,["list"])])]),_:1})]),_:1})}}});export{Oe as default};
